res_index based partitioning